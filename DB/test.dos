csvFilePath = "E:/DolphinDB/201101"

def testFunc() {
    sleep(10000)
}


def waitForJobs(mutable jobIds) {
    again = true
    do {
         again = false
         for(i in 0:size(jobIds)) {
            if(jobIds[i] == NULL)
               continue
            res = getJobStatus(jobIds[i])
            if(res.endTime == NULL) {
                again = true
                print(jobIds[i] + " is running! ")
            } else {
                print(jobIds[i] + " complete " + string(res.endTime))
                jobIds[i] = NULL
            }
         }
         sleep(2000)

    } while(again)
   
    print("All Done!")
}

jobsID = []
for(j in 0:9) {
    jobsID.append!(submitJob("Job_" + j,"Job_" + j, testFunc))
    print("Submit Job : " + j)
}

waitForJobs(jobsID)